(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{454:function(t,v,_){"use strict";_.r(v);var e=_(16),s=Object(e.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h2",{attrs:{id:"react理念"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#react理念"}},[t._v("#")]),t._v(" React理念")]),t._v(" "),_("blockquote",[_("p",[t._v("React 是用 JavaScript 构建"),_("strong",[t._v("快速响应")]),t._v("的大型 Web 应用程序的首选方式。")])]),t._v(" "),_("p",[t._v("所以React的关键实现"),_("code",[t._v("快速响应")]),t._v("，那么制约"),_("code",[t._v("快速响应")]),t._v("的因素是什么呢？")]),t._v(" "),_("p",[t._v("在日常使用网页时，有两类场景会制约"),_("code",[t._v("快速响应")]),t._v("：")]),t._v(" "),_("ul",[_("li",[t._v("遇到需要大量计算的操作时使页面掉帧，造成卡顿")]),t._v(" "),_("li",[t._v("在发送网络请求时，由于数据传输过程中的往返时延，导致的等待")])]),t._v(" "),_("p",[t._v("这两类场景可以概括为：")]),t._v(" "),_("ul",[_("li",[t._v("CPU的瓶颈")]),t._v(" "),_("li",[t._v("IO的瓶颈")])]),t._v(" "),_("h2",{attrs:{id:"react解决方式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#react解决方式"}},[t._v("#")]),t._v(" React解决方式")]),t._v(" "),_("h3",{attrs:{id:"cpu的瓶颈"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#cpu的瓶颈"}},[t._v("#")]),t._v(" CPU的瓶颈")]),t._v(" "),_("p",[t._v("由于"),_("code",[t._v("JS")]),t._v("可以操作"),_("code",[t._v("DOM")]),t._v("，"),_("code",[t._v("GUI")]),t._v("渲染现成与"),_("code",[t._v("JS")]),t._v("线程是互斥的，所以"),_("strong",[t._v("JS脚本的执行")]),t._v("和"),_("strong",[t._v("浏览器布局")]),t._v("、"),_("strong",[t._v("绘制")]),t._v("是不能同时执行的。")]),t._v(" "),_("p",[t._v("且电脑屏幕每次刷新的"),_("em",[t._v("16.6ms")]),t._v("内，需要完成：")]),t._v(" "),_("div",{staticClass:"language- extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("JS脚本执行 --\x3e 样式布局 --\x3e 页面绘制\n")])])]),_("p",[t._v("所以，在一帧当中，"),_("code",[t._v("JS")]),t._v("脚本执行时间过长，显然会导致后续的渲染流水线执行时间缩短，甚至没有时间执行，就造成页面掉帧和用户感知的卡顿。")]),t._v(" "),_("p",[t._v("解决方式：在浏览器的每一帧时间中，会预留一些时间给"),_("code",[t._v("JS")]),t._v("线程，"),_("code",[t._v("React")]),t._v("会利用这部分时间更新组件（预留时间是"),_("code",[t._v("5ms")]),t._v("）。当预留的时间不够时，"),_("code",[t._v("React")]),t._v("就会将线程控制权交还给浏览器使其有时间执行渲染流水线的工作，而"),_("code",[t._v("React")]),t._v("则会等待下一帧来继续执行被中断的工作。")]),t._v(" "),_("blockquote",[_("p",[t._v("这种将长任务拆分成多段，每次执行一小段的任务的操作，被称为"),_("strong",[t._v("时间切片")]),t._v("（time slice）")])]),t._v(" "),_("p",[_("code",[t._v("React")]),t._v("的新模式"),_("code",[t._v("Concurrent Mode")]),t._v("（并发模式）就会默认使用"),_("strong",[t._v("时间切片")]),t._v("（具体可以看"),_("RouterLink",{attrs:{to:"/docs/architecture/scheduler.html"}},[t._v("这篇")]),t._v("介绍）这种特性。")],1),t._v(" "),_("div",{staticClass:"language-js extra-class"},[_("pre",{pre:!0,attrs:{class:"language-js"}},[_("code",[_("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过使用ReactDOM.createRoot开启Concurrent Mode")]),t._v("\nReactDOM"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("createRoot")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rootEl"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("App"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),_("p",[t._v("所以，解决CPU瓶颈的关键是实现"),_("strong",[t._v("时间切片")]),t._v("，而"),_("strong",[t._v("时间切片")]),t._v("的关键是：将"),_("strong",[t._v("同步的更新")]),t._v("变为"),_("strong",[t._v("异步可中断的更新")]),t._v("。")]),t._v(" "),_("h3",{attrs:{id:"io的瓶颈"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#io的瓶颈"}},[t._v("#")]),t._v(" IO的瓶颈")]),t._v(" "),_("p",[t._v("对应的网络延迟是前端开发人员无法解决的问题，那么在客观因素的影响下，如何减少用户对网络延迟的感知呢？")]),t._v(" "),_("p",[t._v("React给处的答案是将"),_("code",[t._v("人机交互研究的结果整合到真实的UI中")]),t._v("。")]),t._v(" "),_("p",[t._v("简单来说，就是在等待的过程中通过显示"),_("code",[t._v("loading")]),t._v("效果，来减少用户对网络延迟的感知。")]),t._v(" "),_("p",[t._v("为此，React对应的实现方式是"),_("code",[t._v("Suspense")]),t._v("（具体可以看"),_("RouterLink",{attrs:{to:"/docs/concurrent/suspense.html"}},[t._v("这篇")]),t._v("介绍）以及"),_("code",[t._v("useTransition hook")]),t._v("(具体可以看"),_("RouterLink",{attrs:{to:"/docs/hooks/useTransition.html"}},[t._v("这篇")]),t._v("介绍)。")],1),t._v(" "),_("p",[t._v("而在源码的内部，为了支持这种特性，React更新的方式也从"),_("strong",[t._v("同步的更新")]),t._v("变为"),_("strong",[t._v("异步可中断的更新")]),t._v("。")])])}),[],!1,null,null,null);v.default=s.exports}}]);